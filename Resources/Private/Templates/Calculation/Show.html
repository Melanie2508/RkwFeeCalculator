{namespace rkwCalculation=RKW\RkwFeecalculator\ViewHelpers}

<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" data-namespace-typo3-fluid="true">
<f:layout name="Default" />

This Template is responsible for displaying a single view for a domain object

If you modify this template, do not forget to change the overwrite settings
in /Configuration/ExtensionBuilder/settings.yaml:
  Resources:
    Private:
      Templates:
        Show.html: keep

Otherwise your changes will be overwritten the next time you save the extension in the extension builder

<f:section name="main">

  <f:render partial="FormErrors" arguments="{object:Calculation}" />

    <div class="flex-container">
        <div class="flex-basis-12 full-width-medium">
            <f:form
                class="form flex space-between rkw-feecalculator"
                action="store"
                name="calculation"
                object="{calculation}"
            >
                <f:form.hidden property="calculator" id="calculator" />
                <f:form.hidden property="previousSelectedProgram" id="previousSelectedProgram" />

                <h2>{calculation.calculator.name}</h2>
                <div class="form__field">
                    <label class="" for="selectedProgram">
                        <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.selected_program" />
                    </label>
                    <f:form.select
                        class="select-field"
                        id="selectedProgram"
                        property="selectedProgram"
                        options="{assignedPrograms}"
                        optionValueField="uid"
                        optionLabelField="name"
                        prependOptionLabel="{f:translate(key: 'tx_rkwfeecalculator_domain_model_program.form.select')}"
                        prependOptionValue=""
                        additionalAttributes="{onChange : 'this.form.submit();'}"
                    />
                </div>

                <f:if condition="{calculation.selectedProgram}">

                    <h3>
                        <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.fee_calculation" />
                    </h3>

                    <div class="form__field width50 width100">
                        <label class="" for="days">
                            <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.days" />
                        </label>
                        <f:if condition="<rkwCalculation:possibleDays program='{calculation.selectedProgram}'/>">
                            <f:then>
                                <f:form.select
                                    class="select-field"
                                    id="days"
                                    property="days"
                                    options="<rkwCalculation:possibleDays program='{calculation.selectedProgram}'/>"
                                    prependOptionLabel="{f:translate(key:'tx_rkwfeecalculator_domain_model_program.form.select')}" prependOptionValue="0"/>
                            </f:then>
                            <f:else>
                                <f:form.textfield
                                    class="align-right"
                                    id="days"
                                    property="days"
                                    additionalAttributes="{autocomplete:'days'}"
                                />
                            </f:else>
                        </f:if>
                    </div>

                    <div class="form__field width50 width100">
                        <label class="" for="consultantFeePerDay">
                            <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.consultant_fee_per_day" />
                        </label>
                        <f:form.textfield
                            class="align-right"
                            property="consultantFeePerDay"
                            id="consultantFeePerDay"
                            additionalAttributes="{autocomplete:'consultantFeePerDay'}"
                            placeholder="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.consultant_fee_per_day.placeholder')}"
                            value="<rkwCalculation:zeroPlaceholder value='{calculation.consultantFeePerDay}'/>"
                        />
                    </div>

                </f:if>

                <div class="form__field flex space-start full-width-narrow">
                    <button class="btn btn--primary full-width-narrow" type="submit">
                        <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.submit" />
                    </button>
                </div>

            </f:form>

            <f:if condition="{calculation.showResults}">

                <rkwCalculation:calculation calculation="{calculation}">

                    <f:for each="{calculationResult}" as="resultItem"> <!-- notwendig? -->
                        <div class="table-wrapper flex-container my-1">
                            <table class="table flex-basis-12 responsive-table">
                                <thead class="table-header">
                                <tr>
                                    <th></th>
                                    <th class="table__heading align-center">
                                        <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.number_of_days" />
                                    </th>
                                    <th></th>
                                    <th class="table__heading align-center">
                                        <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.consultant_fee_per_day" />
                                    </th>
                                    <th></th>
                                    <th class="table__heading align-center">
                                        <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.amount" />
                                    </th>
                                    <th class="table__heading align-center">
                                        <f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.funding_amount" />
                                    </th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td class="table__topic">
                                        <b><f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.consultant_fee" /></b>
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.number_of_days')}">
                                        {calculation.days}
                                    </td>
                                    <td class="table__score">x</td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.consultant_fee_per_day')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {calculation.consultantFeePerDay}
                                        </f:format.number>
                                        Euro
                                    </td>
                                    <td class="table__score">=</td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.amount')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.consultantFee}
                                        </f:format.number>
                                        Euro
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.funding_amount')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.consultantFeeSubvention}
                                        </f:format.number>
                                        Euro
                                    </td>
                                </tr>
                                <tr>
                                    <td class="table__topic">
                                        <b><f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.rkw_fee" /></b>
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.number_of_days')}">
                                        {calculation.days}
                                    </td>
                                    <td class="table__score">x</td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.consultant_fee_per_day')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.rkwFeePerDay}
                                        </f:format.number>
                                        Euro
                                    </td>
                                    <td class="table__score">=</td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.amount')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.rkwFee}
                                        </f:format.number>
                                        Euro
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.funding_amount')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.rkwFeeSubvention}
                                        </f:format.number>
                                        Euro
                                    </td>
                                </tr>
                                <tr class="fontweight-bold">
                                    <td class="table__topic" colspan="5">
                                        <b><f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.subtotal" /></b>
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.subtotal')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.subtotal}
                                        </f:format.number>
                                        Euro
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.funding_amount')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.subventionTotal}
                                        </f:format.number>
                                        Euro
                                    </td>
                                </tr>
                                <tr>
                                    <td class="table__topic" colspan="5">
                                        <b><f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.funding" /></b>
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.amount')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.funding}
                                        </f:format.number>
                                        Euro
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.funding_amount')}">
                                        <f:format.number decimals="0" decimalSeparator=",">{resultItem.fundingPercentage}
                                        </f:format.number>
                                        %
                                    </td>
                                </tr>
                                <tr>
                                    <td class="table__topic" colspan="5">
                                        <b><f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.own_funding_net" /></b>
                                    </td>
                                    <td class="table__score align-right" data-label="{f:translate(key: 'tx_rkwfeecalculator_domain_model_calculation.form.amount')}">
                                        <f:format.number decimals="2" decimalSeparator="," thousandsSeparator=".">
                                            {resultItem.ownFundingNet}
                                        </f:format.number>
                                        Euro
                                    </td>
                                    <td class="table__score"></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="v320-1">

                            <h3><f:translate key="tx_rkwfeecalculator_domain_model_calculation.form.overview_condition_content" /></h3>

                            <f:format.html>{calculation.selectedProgram.content}</f:format.html>

                        </div>

                    </f:for>

                </rkwCalculation:calculation>

            </f:if>

        </div>

    </div>

</f:section>
</html>